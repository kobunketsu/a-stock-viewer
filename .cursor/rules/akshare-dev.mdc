---
description: akshareæ•°æ®è·å–æµ‹è¯•æ¡†æ¶è§„èŒƒ
globs: ["**/*test*.py", "**/*_test.py", "**/test_*.py", "**/tests/**/*.py"]
---

# akshareæµ‹è¯•æ¡†æ¶è§„èŒƒ

## ğŸš¨ è‡ªåŠ¨åº”ç”¨è§„åˆ™
**CRITICAL**: å½“æ¶‰åŠakshareæ•°æ®è·å–ã€è‚¡ç¥¨åˆ†æã€æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ç­‰æµ‹è¯•æ—¶ï¼Œå¿…é¡»è‡ªåŠ¨åº”ç”¨ä»¥ä¸‹æ ‡å‡†æ¨¡æ¿ï¼š

### æ ‡å‡†æµ‹è¯•æ¨¡æ¿
```python
python -c "
import sys
sys.path.insert(0, '/opt/homebrew/lib/python3.9/site-packages')

import pandas as pd
import numpy as np
import akshare as ak
from datetime import datetime, timedelta

# æµ‹è¯•ä»£ç å†…å®¹
print('æµ‹è¯•å¼€å§‹...')
try:
    # å…·ä½“æµ‹è¯•é€»è¾‘
    pass
except Exception as e:
    print(f'é”™è¯¯: {e}')
    import traceback
    traceback.print_exc()
"
```

### è‡ªåŠ¨åº”ç”¨æ¡ä»¶
- âœ… ç”¨æˆ·è¦æ±‚æµ‹è¯•akshareæ•°æ®è·å–åŠŸèƒ½
- âœ… ç”¨æˆ·è¦æ±‚æµ‹è¯•è‚¡ç¥¨åˆ†æåŠŸèƒ½
- âœ… ç”¨æˆ·è¦æ±‚æµ‹è¯•æŠ€æœ¯æŒ‡æ ‡è®¡ç®—
- âœ… ç”¨æˆ·è¦æ±‚éªŒè¯æ•°æ®æ¥å£
- âœ… ç”¨æˆ·è¦æ±‚è°ƒè¯•æ•°æ®ç›¸å…³é—®é¢˜
- âœ… ä»»ä½•æ¶‰åŠpandasã€numpyã€akshareçš„æµ‹è¯•åœºæ™¯

### æ ¸å¿ƒç»„ä»¶
1. **è·¯å¾„è®¾ç½®**: `sys.path.insert(0, '/opt/homebrew/lib/python3.9/site-packages')`
2. **åŸºç¡€åº“å¯¼å…¥**: pandas, numpy, akshare, datetime
3. **é”™è¯¯å¤„ç†**: å®Œæ•´çš„try-exceptå’Œtracebackè¾“å‡º
4. **è°ƒè¯•ä¿¡æ¯**: è¯¦ç»†çš„printè¾“å‡ºå’Œé”™è¯¯è¿½è¸ª

### æŠ€æœ¯ç‰¹ç‚¹
- **ç¯å¢ƒéš”ç¦»**: ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„PythonåŒ…è·¯å¾„
- **é”™è¯¯è¿½è¸ª**: å®Œæ•´çš„å¼‚å¸¸ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ª
- **è°ƒè¯•å‹å¥½**: è¯¦ç»†çš„è¾“å‡ºä¿¡æ¯ä¾¿äºé—®é¢˜å®šä½
- **å¯é‡å¤æ€§**: æ ‡å‡†åŒ–çš„æµ‹è¯•ç¯å¢ƒç¡®ä¿ç»“æœä¸€è‡´

## æ•°æ®è·å–æµ‹è¯•è§„èŒƒ

### akshareæ¥å£æµ‹è¯•
```python
# æµ‹è¯•è‚¡ç¥¨æ•°æ®è·å–
def test_stock_data():
    try:
        # è·å–è‚¡ç¥¨å®æ—¶è¡Œæƒ…
        stock_data = ak.stock_zh_a_spot_em()
        print(f"è‚¡ç¥¨æ•°æ®è·å–æˆåŠŸï¼Œå…±{len(stock_data)}æ¡è®°å½•")
        return stock_data
    except Exception as e:
        print(f"è‚¡ç¥¨æ•°æ®è·å–å¤±è´¥: {e}")
        return None
```

### æŠ€æœ¯æŒ‡æ ‡æµ‹è¯•
```python
# æµ‹è¯•RSIè®¡ç®—
def test_rsi_calculation():
    try:
        # è·å–è‚¡ç¥¨æ•°æ®
        data = ak.stock_zh_a_hist(symbol="000001", period="daily", start_date="20240101", end_date="20241231")
        
        # è®¡ç®—RSI
        # ... RSIè®¡ç®—é€»è¾‘
        
        print("RSIè®¡ç®—æµ‹è¯•æˆåŠŸ")
        return True
    except Exception as e:
        print(f"RSIè®¡ç®—æµ‹è¯•å¤±è´¥: {e}")
        return False
```

## é”™è¯¯å¤„ç†è§„èŒƒ
- æ‰€æœ‰akshare APIè°ƒç”¨å¿…é¡»åŒ…å«try-catchå—
- ä½¿ç”¨`error_msg = str(e)`ä»£æ›¿ç›´æ¥å¼•ç”¨å¼‚å¸¸å¯¹è±¡
- é”™è¯¯æ—¥å¿—å¿…é¡»åŒ…å«æ—¶é—´æˆ³å’Œè¯¦ç»†ä¸Šä¸‹æ–‡
- æ•°æ®è·å–å¤±è´¥æ—¶æä¾›é™çº§æ–¹æ¡ˆ

## æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨ç¼“å­˜æœºåˆ¶é¿å…é‡å¤APIè°ƒç”¨
- æ‰¹é‡å¤„ç†æ•°æ®å‡å°‘å†…å­˜å ç”¨
- å¼‚æ­¥å¤„ç†å¤§é‡æ•°æ®è·å–ä»»åŠ¡
- åˆç†ä½¿ç”¨pandaså‘é‡åŒ–æ“ä½œ
